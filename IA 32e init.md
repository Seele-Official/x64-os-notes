

操作系统应遵循以下顺序来初始化 IA-32e 模式：
1. 从保护模式开始，通过设置 CR0.PG = 0 来禁用分页。使用 MOV CR0 指令禁用分页。
   > *MOV CR0 必须在 Identity-mapped（同一映射）中使用。就是指逻辑地址（也就是虚拟地址）和物理地址是相同的。*
2. 通过设置 CR4.PAE = 1 来启用物理地址扩展 (PAE)。如果无法启用PAE，则在尝试初始化 IA-32e 模式时将导致 #GP 错误。
3. 使用 4 级页表 (PML4) 的物理基址加载 CR3。
4. 通过设置 IA32_EFER.LME = 1 来启用 IA-32e 模式。
5. 通过设置 CR0.PG = 1 来启用分页。这会导致处理器将 IA32_EFER.LMA 位设置为 1。
   > *启用分页的 MOV CR0 指令和以下指令必须位于同一映射页面中，直到跳转到非同一映射页面的分支。*